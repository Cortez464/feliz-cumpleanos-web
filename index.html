<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>¬°Una Sorpresa para Ti! ‚ù§Ô∏è</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Librer√≠a de Confeti Profesional -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Roboto:wght@300;400;700&family=Share+Tech+Mono&display=swap');

    /* Variables de Estilo Rom√°ntico */
    :root {
      --color-primary: #FF69B4; /* Rosa Vibrante */
      --color-secondary: #FFD700; /* Dorado Suave */
      --color-error: #FF0000; /* Rojo Intenso */
      --font-code: 'Share Tech Mono', monospace;
      --font-body: 'Roboto', sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: black;
      font-family: var(--font-body);
      overflow-x: hidden;
      color: white;
    }

    /* Fondo animado (se activa al final) */
    .romantic-bg {
      background: linear-gradient(-45deg, #FF69B4, #9D50BB, #EE7752, #FFD700);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
    }

    @keyframes gradient {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    /* --- FASE 0: SECUENCIA ROM√ÅNTICA DE ARRANQUE --- */
    #boot-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: black;
      z-index: 100;
      padding: 20px;
      font-family: var(--font-code);
      color: var(--color-secondary); /* Texto dorado */
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
    }
    
    .terminal-line {
      margin: 2px 0;
      opacity: 0.9;
      text-shadow: 0 0 5px var(--color-secondary); /* Brillo dorado */
    }

    /* --- FASE 1: CAJA DE REGALO / BLOQUEO INICIAL --- */
    #welcome-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.95);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 50;
      transition: all 0.8s ease-out;
    }

    .gift-box {
      font-size: 100px;
      cursor: pointer;
      user-select: none;
      transition: transform 0.1s;
    }

    /* Animaciones de Suspenso */
    .shake-mild { animation: shake 0.5s; }
    .shake-hard { animation: shake 0.5s infinite; color: var(--color-primary); }
    .shake-error { animation: shake 0.3s; border-color: var(--color-error) !important; }
    
    /* Alarma visual (Rojo de Tensi√≥n) */
    .red-flash {
      animation: flashRed 0.5s;
    }
    
    @keyframes flashRed {
      0%, 100% { background: rgba(0,0,0,0.95); }
      50% { background: rgba(255,0,0,0.3); } /* Rojo menos agresivo */
    }
    
    @keyframes shake {
      0% { transform: translate(1px, 1px) rotate(0deg); }
      10% { transform: translate(-1px, -2px) rotate(-1deg); }
      20% { transform: translate(-3px, 0px) rotate(1deg); }
      30% { transform: translate(3px, 2px) rotate(0deg); }
      40% { transform: translate(1px, -1px) rotate(1deg); }
      50% { transform: translate(-1px, 2px) rotate(-1deg); }
      60% { transform: translate(-3px, 1px) rotate(0deg); }
      70% { transform: translate(3px, 1px) rotate(-1deg); }
      80% { transform: translate(-1px, -1px) rotate(1deg); }
      90% { transform: translate(1px, 2px) rotate(0deg); }
      100% { transform: translate(1px, -2px) rotate(-1deg); }
    }

    /* EFECTO GLITCH (Transici√≥n R√°pida) */
    .glitch-effect {
      animation: glitch-anim 0.3s cubic-bezier(.25, .46, .45, .94) both infinite;
      color: var(--color-primary); /* Glitch rosa */
      background: black;
    }

    @keyframes glitch-anim {
      0% { transform: translate(0) }
      20% { transform: translate(-2px, 2px) }
      40% { transform: translate(-2px, -2px) }
      60% { transform: translate(2px, 2px) }
      80% { transform: translate(2px, -2px) }
      100% { transform: translate(0) }
    }

    /* --- FASE 1.5: CUENTA REGRESIVA ROM√ÅNTICA --- */
    #countdown-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: black;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 60;
      font-family: var(--font-code);
      color: var(--color-primary); /* Texto rosa */
      text-shadow: 0 0 5px var(--color-primary);
    }

    .lock-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      color: var(--color-secondary); /* Candado dorado */
      animation: pulse 2s infinite;
    }

    .timer-display {
      font-size: clamp(2rem, 5vw, 4rem);
      border: 2px solid var(--color-secondary); /* Borde dorado */
      padding: 20px;
      border-radius: 10px;
      background: rgba(255, 105, 180, 0.1); /* Fondo rosa transparente */
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
      margin: 20px 0;
    }

    @keyframes pulse {
      0% { opacity: 1; text-shadow: 0 0 10px var(--color-secondary); }
      50% { opacity: 0.7; text-shadow: 0 0 0px var(--color-secondary); }
      100% { opacity: 1; text-shadow: 0 0 10px var(--color-secondary); }
    }
    
    /* Input de Contrase√±a Estilo B√≥veda Secreta */
    #password-container {
      display: none;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
      animation: fadeIn 0.5s;
    }

    .vault-input {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid var(--color-secondary); /* Borde dorado */
      color: white;
      font-family: var(--font-code);
      padding: 10px 15px;
      border-radius: 5px;
      text-align: center;
      font-size: 1.2rem;
      outline: none;
      width: 250px;
      letter-spacing: 2px;
      transition: border-color 0.3s;
    }

    .vault-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .vault-btn {
      margin-top: 15px;
      background: var(--color-primary); /* Bot√≥n rosa */
      color: white;
      font-family: var(--font-body);
      padding: 10px 25px;
      border: 1px solid var(--color-primary);
      font-weight: bold;
      cursor: pointer;
      border-radius: 20px;
      transition: background 0.3s, transform 0.1s;
    }

    .vault-btn:hover { 
      background: transparent;
      border-color: var(--color-primary);
      color: var(--color-primary); 
      transform: scale(1.05);
    }

    /* CONTENIDO PRINCIPAL */
    #main-content {
      display: none; 
      opacity: 0;
      transition: opacity 2s ease-in;
    }

    .container {
      text-align: center;
      padding: 30px;
      max-width: 800px;
      margin: 40px auto;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.2);
    }

    h1 {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(3rem, 6vw, 5rem);
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .video-wrapper {
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 20px 50px rgba(0,0,0,0.6);
      margin: 30px 0;
      background: black;
    }
    
    iframe { width: 100%; height: 100%; }

    #love-letter {
      font-size: 1.25rem;
      line-height: 1.8;
      min-height: 100px;
    }
    
    .cursor::after {
      content: '|';
      animation: blink 1s infinite;
    }
    
    @keyframes blink { 50% { opacity: 0; } }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>

  <!-- FASE 0: TERMINAL DE ARRANQUE ROM√ÅNTICO -->
  <div id="boot-screen"></div>

  <!-- FASE 1: SUSPENSO Y B√ìVEDA SECRETA -->
  <div id="welcome-screen">
    <div id="gift-icon" class="gift-box" onclick="gestionarClics()">üéÅ</div>
    
    <p id="status-msg" class="text-white text-xl mt-6 font-light tracking-widest uppercase text-center px-4">
      Conexi√≥n.Estado(Pareja: Disponible)
    </p>
    <p id="hint-msg" class="text-white text-xs mt-2 opacity-50 font-sans">(Tocar el cofre para iniciar conexi√≥n)</p>

    <div id="password-container">
      <!-- PISTA DE CONTRASE√ëA AGREGADA AQU√ç -->
      <p class="text-gold-400 font-sans text-lg mb-2 text-center">CLAVE SECRETA DE APERTURA</p>
      <p class="text-sm opacity-70 mb-4 text-center text-pink-300">(PISTA: La fecha en que unimos nuestras vidas)</p>

      <input type="text" id="wedding-date" class="vault-input" placeholder="DD-MM-AAAA">
      <button onclick="verificarPassword()" class="vault-btn">ABRIR B√ìVEDA</button>
      <p id="error-msg" class="text-red-500 font-sans text-xs mt-2 h-4"></p>
    </div>
  </div>

  <!-- FASE 1.5: PANTALLA DE BLOQUEO TEMPORAL -->
  <div id="countdown-screen">
    <div class="lock-icon">üîí</div>
    <h2 class="text-2xl mb-4 text-center px-4 font-sans uppercase">ACCESO AUTORIZADO PERO CONGELADO EN EL TIEMPO</h2>
    <p class="text-sm opacity-70 mb-6 font-sans">El coraz√≥n se abre a la hora programada</p>
    
    <div class="timer-display" id="timer">
      00d 00h 00m 00s
    </div>
    
    <p class="mt-8 text-sm blink-text animate-pulse font-sans">> ESPERANDO EL MOMENTO PERFECTO...</p>
  </div>

  <!-- FASE 2: EL SHOW ROM√ÅNTICO -->
  <div id="main-content">
    <div class="container mx-auto px-4">
      <h1>¬°Feliz Cumplea√±os!</h1>
      <h2 class="text-3xl font-light mb-6">Mi esposa amada ‚ù§Ô∏è</h2>
      
      <p id="love-letter" class="mb-8 font-light"></p>

      <div class="video-wrapper">
        <iframe 
          id="video-frame" 
          src="https://drive.google.com/file/d/1s5cP8TqO7SEDR-95qC9w0on92g3BOUyT/preview" 
          frameborder="0"
          allow="autoplay; fullscreen"
          allowfullscreen>
        </iframe>
      </div>

      <button onclick="lanzarConfetti()" class="mt-4 px-8 py-3 bg-white text-pink-600 font-bold rounded-full shadow-lg hover:scale-110 transition transform">
        üéâ ¬°TE AMO! üéâ
      </button>
    </div>
  </div>

  <audio id="bg-music" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mp3">
  </audio>

  <script>
    /* ================= CONFIGURACI√ìN ================= */
    // Meses en Javascript son base 0 (Enero=0, Noviembre=10)
    // 26 de Noviembre de 2025, 19:00:00 (7 PM)
    const TARGET_DATE = new Date(2025, 10, 26, 19, 0, 0).getTime();
    const VALID_PASSWORD = '28092024';

    /* ================= FASE 0: BOOT SEQUENCE ROM√ÅNTICA ================= */
    const bootLines = [
        "INICIANDO_CORAZ√ìN_VIRTUAL...",
        "CARGANDO_M√ìDULO_DE_FELICIDAD...",
        "ESTABLECIENDO_CONEXI√ìN_SENTIMENTAL...",
        "FILTRO_DE_RUTINA_IGNORADO.",
        "ESCANENANDO_POR_OBJETIVO: 'AMOR'...",
        "ALMA_GEMELA_IDENTIFICADA.",
        "PAQUETE_DE_DATOS_PRECIOSO_ENCONTRADO.",
        "LANZANDO_INTERFAZ_DE_DESEO..."
    ];

    window.onload = function() {
        const bootScreen = document.getElementById('boot-screen');
        let delay = 0;
        
        bootLines.forEach((line, index) => {
            delay += Math.random() * 500 + 200; 
            setTimeout(() => {
                const p = document.createElement('p');
                p.classList.add('terminal-line');
                p.innerText = "> " + line;
                bootScreen.appendChild(p);
                bootScreen.scrollTop = bootScreen.scrollHeight;
                
                if (index === bootLines.length - 1) {
                    setTimeout(finalizarBoot, 1000);
                }
            }, delay);
        });
    };

    function finalizarBoot() {
        const bootScreen = document.getElementById('boot-screen');
        const welcomeScreen = document.getElementById('welcome-screen');
        bootScreen.style.display = 'none';
        welcomeScreen.style.display = 'flex';
    }

    /* ================= FASE 1: L√ìGICA DE SUSPENSO ================= */
    let clicCount = 0;
    const giftIcon = document.getElementById('gift-icon');
    const statusMsg = document.getElementById('status-msg');
    const hintMsg = document.getElementById('hint-msg');
    const passwordContainer = document.getElementById('password-container');

    function gestionarClics() {
      if (clicCount >= 3) return;
      clicCount++;

      if (clicCount === 1) {
        giftIcon.classList.remove('bounce'); 
        void giftIcon.offsetWidth; 
        giftIcon.classList.add('shake-mild');
        statusMsg.innerText = "Error 403: No tienes la llave maestra.";
        statusMsg.style.fontFamily = "var(--font-code)";
        
      } else if (clicCount === 2) {
        giftIcon.classList.remove('shake-mild');
        void giftIcon.offsetWidth;
        giftIcon.classList.add('shake-hard');
        statusMsg.innerText = "¬°ALERTA! B√ìVEDA DE SENTIMIENTOS PROTEGIDA.";
        statusMsg.style.color = "var(--color-primary)";
        statusMsg.classList.add('font-bold');

      } else if (clicCount === 3) {
        mostrarPasswordInput();
      }
    }

    function mostrarPasswordInput() {
      giftIcon.style.cursor = "default";
      giftIcon.classList.remove('shake-hard');
      statusMsg.innerText = "SE REQUIERE C√ìDIGO DE CONFIANZA";
      statusMsg.style.color = "var(--color-secondary)"; 
      statusMsg.style.fontFamily = "var(--font-code)";
      hintMsg.style.display = 'none';
      passwordContainer.style.display = 'flex';
    }

    function verificarPassword() {
      const input = document.getElementById('wedding-date');
      const errorMsg = document.getElementById('error-msg');
      const welcomeScreen = document.getElementById('welcome-screen');
      const val = input.value.trim();

      // Validaci√≥n simple para que sea solo d√≠gitos
      const cleanVal = val.replace(/[^0-9]/g, ''); 

      if (cleanVal === VALID_PASSWORD) {
        // Contrase√±a correcta -> Verificar Tiempo
        iniciarSecuenciaGlitch();
      } else {
        // Contrase√±a incorrecta (Alarma Dram√°tica)
        input.classList.add('shake-error');
        welcomeScreen.classList.add('red-flash');
        input.style.borderColor = "var(--color-error)";
        errorMsg.innerText = "CLAVE ERR√ìNEA. INGRESO DENEGADO.";
        setTimeout(() => {
          input.classList.remove('shake-error');
          welcomeScreen.classList.remove('red-flash');
          input.style.borderColor = "var(--color-secondary)";
          errorMsg.innerText = "";
        }, 1000);
      }
    }

    function iniciarSecuenciaGlitch() {
        const welcomeScreen = document.getElementById('welcome-screen');
        welcomeScreen.classList.add('glitch-effect');
        document.getElementById('status-msg').innerText = "VERIFICANDO SELLO DE TIEMPO...";
        
        setTimeout(() => {
            verificarBloqueoTemporal();
        }, 1500);
    }

    /* ================= FASE 1.5: VERIFICACI√ìN TEMPORAL ================= */
    function verificarBloqueoTemporal() {
        const now = new Date().getTime();
        const welcomeScreen = document.getElementById('welcome-screen');
        
        // Quitar la pantalla de bienvenida y el glitch
        welcomeScreen.style.display = 'none'; 
        welcomeScreen.classList.remove('glitch-effect');

        if (now >= TARGET_DATE) {
            // Ya pas√≥ la hora -> Abrir directo
            abrirRegaloDefinitivo();
        } else {
            // A√∫n falta -> Mostrar cuenta regresiva
            iniciarCuentaRegresiva();
        }
    }

    function iniciarCuentaRegresiva() {
        const countdownScreen = document.getElementById('countdown-screen');
        const timerElement = document.getElementById('timer');
        countdownScreen.style.display = 'flex';

        const interval = setInterval(() => {
            const now = new Date().getTime();
            const distance = TARGET_DATE - now;

            if (distance < 0) {
                // TIEMPO CUMPLIDO
                clearInterval(interval);
                countdownScreen.style.display = 'none';
                abrirRegaloDefinitivo();
                return;
            }

            // C√°lculos de tiempo
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Formato con ceros a la izquierda
            timerElement.innerText = 
                (days < 10 ? "0" + days : days) + "d " + 
                (hours < 10 ? "0" + hours : hours) + "h " +
                (minutes < 10 ? "0" + minutes : minutes) + "m " +
                (seconds < 10 ? "0" + seconds : seconds) + "s";
        }, 1000);
    }


    /* ================= FASE 2: APERTURA FINAL ================= */
    function abrirRegaloDefinitivo() {
      // Activar fondo bonito
      document.body.classList.add('romantic-bg');
      document.body.style.background = "";

      const audio = document.getElementById('bg-music');
      audio.volume = 0.5;
      audio.play().catch(e => console.log("Audio play error:", e));

      monitorVideoInteraction(audio);

      const mainContent = document.getElementById('main-content');
      mainContent.style.display = 'block';
      
      setTimeout(() => {
        mainContent.style.opacity = '1';
        typeWriter();
        lanzarConfetti();
      }, 100);
    }

    // --- MONITOR DE FOCO ---
    function monitorVideoInteraction(audioElement) {
      const videoFrame = document.getElementById('video-frame');
      const intervalId = setInterval(() => {
        if (document.activeElement === videoFrame) {
          console.log("Usuario interactu√≥ con el video.");
          audioElement.pause();
          clearInterval(intervalId);
        }
      }, 500);
    }

    /* ================= M√ÅQUINA DE ESCRIBIR ================= */
    const textToType = "Hoy celebro tu vida, tu risa y cada momento juntos. Eres mi roca, mi alegr√≠a y mi mejor amiga. Espero que este video te recuerde lo mucho que te adoro. ¬°Gracias por existir!";
    const speed = 50; 
    let i = 0;

    function typeWriter() {
      if (i < textToType.length) {
        document.getElementById("love-letter").innerHTML += textToType.charAt(i);
        i++;
        setTimeout(typeWriter, speed);
      } else {
        document.getElementById("love-letter").classList.remove("cursor");
      }
    }

    /* ================= CONFETI ================= */
    function lanzarConfetti() {
      var duration = 3 * 1000;
      var animationEnd = Date.now() + duration;
      var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
      var randomInRange = (min, max) => Math.random() * (max - min) + min;

      var interval = setInterval(function() {
        var timeLeft = animationEnd - Date.now();
        if (timeLeft <= 0) return clearInterval(interval);
        var particleCount = 50 * (timeLeft / duration);
        confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
        confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
      }, 250);
    }
  </script>
</body>
</html>
